# ğŸ“ ClassToday Readme

__[2022ë…„ë„ ìƒëª…ëŒ€í•™êµ ì»´í“¨í„°ê³¼í•™ê³¼ ìº¡ìŠ¤í†¤ë””ìì¸ í”„ë¡œì íŠ¸]__

__â­ï¸ í”„ë¡œì íŠ¸ ê°œìš”: ìœ„ì¹˜ ì •ë³´ ê¸°ë°˜ì˜ ì¼íšŒì„± ìˆ˜ì—… ì¤‘ê°œ ì•± ê°œë°œ__

ğŸ“† __í”„ë¡œì íŠ¸ ê¸°ê°„: 2022.01. ~ 2022.09.__

__ğŸ™†â€â™‚ï¸ í´ë˜ìŠ¤íˆ¬ë°ì´ íŒ€ êµ¬ì„±ì›:__ 

    1. ë°•íƒœí˜„ @yescoach - iOS Develop
    1. ê¹€ë¯¼ìƒ @poohyhy - iOS Develop
    1. ì´ì˜ì°¬ @prettyturtle - iOS Develop



## ğŸš€ í”„ë¡œì íŠ¸ ê°œìš”

í´ë˜ìŠ¤íˆ¬ë°ì´ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, ë™ë„¤ ì£¼ë¯¼ë“¤ì´ ê°€ë³ê³  ììœ ë¡­ê²Œ ì¼íšŒì„± ìˆ˜ì—…ì„ ì‚¬ê³  íŒ” ìˆ˜ ìˆë„ë¡ ì¤‘ê°œí•˜ëŠ” í”Œë«í¼ ì•± ì…ë‹ˆë‹¤.



## ğŸ“ ê¸°ìˆ ìŠ¤íƒ

|      iOS Target      |       iOS 14.0        |
| :------------------: | :-------------------: |
|  í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜   |      MVC / MVVM       |
| ê°œë°œ ì–¸ì–´, ê°œë°œ í™˜ê²½ | Swift 5.4, Xcode 13.4 |
|     UI Framework     |   UIKit + Code-base   |
|   ì˜ì¡´ì„± ê´€ë¦¬ë„êµ¬    |     CocoaPod, SPM     |
|       ì„œë²„ DB        |  Firebase Firestore   |



## ğŸ“š ì˜¤í”ˆì†ŒìŠ¤

|
|

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-02-22 15.41.56](/Users/yescoach/Library/Application Support/typora-user-images/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-02-22 15.41.56.png)

### 

## ğŸ“ ê¸°ëŠ¥ ëª…ì„¸ì„œ ë° í”„ë¡œì íŠ¸ ì„¤ê³„

|
|

í´ë˜ìŠ¤íˆ¬ë°ì´ íŒ€ì€ ë…¸ì…˜ì„ í†µí•´ [ê¸°ëŠ¥ ëª…ì„¸ì„œ](https://yescoach.notion.site/5d067b941e2c44498eceda7e15f48408)ì™€ [í”„ë¡œì ìŠ¤ ì„¤ê³„](https://yescoach.notion.site/da72f49e546c4ce5a5f4bb82d584c420)ë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

## ğŸ›¹ ê¸°ëŠ¥ êµ¬í˜„

### 1. ë©”ì¸ í™”ë©´

---

<img src="/Users/yescoach/Downloads/IMG_0026.PNG" alt="IMG_0026" style="zoom:25%;" /> 

(1) ì¹´í…Œê³ ë¦¬ ì •ë ¬ ê¸°ëŠ¥

(2) ìˆ˜ì—… ê²€ìƒ‰ ê¸°ëŠ¥

(3) ì¦ê²¨ì°¾ê¸° ëª©ë¡ ì •ë ¬ ê¸°ëŠ¥

(4) ìœ ì €ì˜ ìœ„ì¹˜ ì„¤ì • ê¸°ëŠ¥

(5) ìˆ˜ì—… ë“±ë¡ ê¸°ëŠ¥

### ì¹´í…Œê³ ë¦¬ ì •ë ¬

<img src="/Users/yescoach/Downloads/IMG_0029.PNG" alt="IMG_0029" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0030.PNG" alt="IMG_0030" style="zoom:25%;" />

>  ì¹´í…Œê³ ë¦¬ ë³„ë¡œ ìˆ˜ì—…ë“¤ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

### ìˆ˜ì—… ê²€ìƒ‰

<img src="/Users/yescoach/Downloads/IMG_0031.PNG" alt="IMG_0031" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0032.PNG" alt="IMG_0032" style="zoom:25%;" />

>  ê²€ìƒ‰ì–´ì— í•´ë‹¹í•˜ëŠ” ìˆ˜ì—…ë“¤ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

### ì¦ê²¨ì°¾ê¸° ì •ë ¬

<img src="/Users/yescoach/Downloads/IMG_0033.PNG" alt="IMG_0033" style="zoom:25%;" />

>  ì¦ê²¨ì°¾ê¸°ë¡œ ë“±ë¡í•œ ìˆ˜ì—…ë“¤ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

### ìœ ì € ìœ„ì¹˜ ì„¤ì • ê¸°ëŠ¥

<img src="/Users/yescoach/Downloads/IMG_0034.PNG" alt="IMG_0034" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0035.PNG" alt="IMG_0035" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0036.PNG" alt="IMG_0036" style="zoom:25%;" />

### ìˆ˜ì—… ë“±ë¡ ê¸°ëŠ¥

<img src="/Users/yescoach/Downloads/IMG_0037.PNG" alt="IMG_0037" style="zoom:25%;" /> 

>  ì¤‘ì•™ì˜ ë“±ë¡ ë²„íŠ¼ì„ í†µí•´ êµ¬ë§¤ê¸€ / íŒë§¤ê¸€ì„ ë“±ë¡í•©ë‹ˆë‹¤.

### 2. ìˆ˜ì—…ì˜ ë“±ë¡

---

<img src="/Users/yescoach/Downloads/IMG_0038.PNG" alt="IMG_0038" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0039.PNG" alt="IMG_0039" style="zoom:25%;" />

> ìˆ˜ì—… êµ¬ë§¤ê¸€/íŒë§¤ê¸€ì„ ë“±ë¡í•˜ë ¤ë©´, ìˆ˜ì—…ì— ëŒ€í•œ ì •ë³´ë“¤ì„ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.

- ì´ë¯¸ì§€ ë“±ë¡

â€‹        <img src="/Users/yescoach/Downloads/IMG_0040.PNG" alt="IMG_0040" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0041.PNG" alt="IMG_0041" style="zoom:25%;" />

- ì¥ì†Œ ë“±ë¡

    <img src="/Users/yescoach/Downloads/IMG_0042.PNG" alt="IMG_0042" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0043.PNG" alt="IMG_0043" style="zoom:25%;" />

    > ì§€ë„ì˜ íŠ¹ì • ìœ„ì¹˜ë¥¼ íƒ­í•˜ë©´, í•€ì´ ì¶”ê°€ë˜ë©° í•´ë‹¹ ì£¼ì†Œì˜ ë„ë¡œëª… ì£¼ì†Œê°€ ì¶”ê°€ë©ë‹ˆë‹¤.

    **í•„ìˆ˜ í•­ëª©ë“¤ì„ ëª¨ë‘ ì‘ì„±í•˜ì—¬ ë“±ë¡í•˜ë©´, í•´ë‹¹ ì§€ì—­ì— ìˆ˜ì—…ì´ ì¶”ê°€ë©ë‹ˆë‹¤.**

<img src="/Users/yescoach/Downloads/IMG_0044.PNG" alt="IMG_0044" style="zoom:25%;" />

### 3. ìˆ˜ì—… ìˆ˜ì • ë° ì‚­ì œ

<img src="/Users/yescoach/Downloads/IMG_0048.PNG" alt="IMG_0048" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0047.PNG" alt="IMG_0047" style="zoom:25%;" />

### 4. ìˆ˜ì—… ìƒì„¸ í™”ë©´

---

<img src="/Users/yescoach/Downloads/IMG_0045.PNG" alt="IMG_0045" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0046.PNG" alt="IMG_0046" style="zoom:25%;" />

### 5. ìˆ˜ì—… ë§¤ì¹­

---

<img src="/Users/yescoach/Downloads/IMG_0049.PNG" alt="IMG_0049" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0050.PNG" alt="IMG_0050" style="zoom:25%;" />

<img src="/Users/yescoach/Downloads/IMG_0051.PNG" alt="IMG_0051" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0052.PNG" alt="IMG_0052" style="zoom:25%;" />



### 6. ë§µë·°

---

<img src="/Users/yescoach/Downloads/IMG_0053.PNG" alt="IMG_0053" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0055.PNG" alt="IMG_0055" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0056.PNG" alt="IMG_0056" style="zoom:25%;" />

### 7. ì±„íŒ…

---

<img src="/Users/yescoach/Downloads/IMG_0058.PNG" alt="IMG_0058" style="zoom:25%;" /><img src="/Users/yescoach/Downloads/IMG_0057.PNG" alt="IMG_0057" style="zoom:25%;" />

### 8. í”„ë¡œí•„

---

<img src="/Users/yescoach/Downloads/IMG_0059.PNG" alt="IMG_0059" style="zoom:25%;" />

### 9. íšŒì›ê°€ì…



## âš’ï¸ Clean Architecture ì ìš©

**ê°œìš”: ê¸°ì¡´ì˜ MVC êµ¬ì¡°ì—ì„œ Clean Architectureì„ ì ìš©í•œ MVVM êµ¬ì¡°ë¡œ ë¦¬íŒ©í† ë§ ì§„í–‰**

**í”„ë¡œì íŠ¸ ê¸°ê°„: 2023.01. ~ 2023.02.**

**ì£¼ìš” ê°œë…: MVVM, Clean Architecture, Dependency Container, Repository Pattern**

## â›”ï¸ ê¸°ì¡´ í”„ë¡œì íŠ¸ êµ¬ì¡°

<img src="/Users/yescoach/Library/Application Support/typora-user-images/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-02-23 18.15.33.png" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-02-23 18.15.33" style="zoom:80%;" />

## ğŸŸ¢ Clean Architecture ì ìš©

<img src="/Users/yescoach/Library/Application Support/typora-user-images/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-02-23 17.28.21.png" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-02-23 17.27.09" style="zoom:80%;" />

>   ì°¸ê³ í•œ í”„ë¡œì íŠ¸: https://github.com/kudoleh/iOS-Clean-Architecture-MVVM

 ### Layer ë³„ êµ¬ì„±ìš”ì†Œ

-   **Domain Layer**
    -   Entities: Business Rules, Business Model
    -   UseCases: Application Business Rules
    -   Interfaces: Repositories Interfaces
-   **Presentation Layer**
    -   View: `ViewController`ì™€ `ViewModel(Presenters)`, `SubView`
    -   Utilities: Delegates, Framework type extensions
-   **Data Layer**
    -   Repositories: Repositories Implementations
    -   PersistentStorages: Persistence DB
-   Infrastructure
    -   Network: Server Network Managers(Firebase, Naver API, Kakao API ë“±)
    -   Services: Core Location, Image Cache Manager ë“± Framework ê´€ë ¨ ë§¤ë‹ˆì € ê°ì²´

### Dependency Container

---

Clean Architectureë¥¼ ì ìš©í•˜ë©´ì„œ `Repository`, `UseCase` ì™€ ì´ë¥¼ ê°€ì§€ê³  ë°ì´í„°ë¥¼ êµ¬ì„±í•˜ëŠ” Presenterì¸ `ViewModel`, UIë¡œ ë³´ì—¬ì£¼ëŠ” `ViewController`ì—ì„œ ëª¨ë‘ ì˜ì¡´ì„± ì£¼ì…ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í• ë•Œ ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ì„±ì„ ì£¼ì…í•˜ëŠ”ë°, ì´ ì˜ì¡´ì„± ì£¼ì…ì„ í•œ ê³³ì—ì„œ ì „ë‹´í•´ì„œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ `Dependency Container` ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

**ì¥ì **

-   ë§¤ë²ˆ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ì‹œ ì¤‘ë³µë˜ë˜ ì½”ë“œë¥¼ `Dependency Container` ë¥¼ í†µí•´ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤(`Repository`,` Usecase` ì˜ ìƒì„±, ì£¼ì… ë“±)
-   ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒì„±ê³¼ ì˜ì¡´ì„±ì„ `Dependency Container`ì—ì„œ ê´€ë¦¬í•˜ë¯€ë¡œ, ì´ì™¸ì˜ ì˜ì—­ì—ì„œëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Repository Pattern

---

**ë°ì´í„°(DB, API)ì˜ ì¶œì²˜ì— ê´€ê³„ì—†ì´ ë™ì¼í•œ ì¸í„°í˜ì´ìŠ¤ë¡œ ì ‘ê·¼í•˜ê²Œ í•˜ëŠ” ë””ìì¸ íŒ¨í„´ ì…ë‹ˆë‹¤.**

`ViewModel`ì€ ì¶”ìƒí™”ëœ `Repository`ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ë°ì´í„°ì— ì ‘ê·¼í•˜ì—¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•˜ë©°,
`Repository`ëŠ” í•´ë‹¹ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ ì‹¤ì œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ê³  ê°€ê³µí•©ë‹ˆë‹¤.

**ì¥ì **

-   Presenterì¸ `ViewModel`ì€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.
-   `ViewModel`ì€ ì¶”ìƒí™”ëœ `Repository`ì— ì ‘ê·¼í•˜ë¯€ë¡œ ê°ì²´ ê°„ ê²°í•©ë„ê°€ ê°ì†Œí•©ë‹ˆë‹¤.
-   `ë°ì´í„°(DB, API) ì¶œì²˜` ë° `ë°ì´í„° ë¡œì§`ì˜ ìœ ì—°í•œ ë³€ê²½ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. `ViewModel`ì€ ì•„ë¬´ ì˜í–¥ ì—†ìŠµë‹ˆë‹¤.
-   ì¼ê´€ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Repository Pattern + Use Case

---

Clean Architectureì—ì„œëŠ”  `ViewModel` ì™€ `Repository` ì‚¬ì´ì— `UseCase` ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.

`Use Case`ëŠ” ì•±ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì„ í¬í•¨í•œ ëª¨ë“  ìœ ìŠ¤ì¼€ì´ìŠ¤ë¥¼ ìº¡ìŠí™”í•˜ì—¬ êµ¬í˜„í•œ ê°ì²´ì…ë‹ˆë‹¤.

`Use Case`ëŠ” `Repository`ì˜ ì¸í„°í˜ì´ìŠ¤ì— ì ‘ê·¼í•˜ì—¬ ë°ì´í„°ë¥¼ ë°›ì•„ì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.(= ì˜ì¡´ì„± ì£¼ì…)
= `Use Case`ì˜ ë³€ê²½ì´ `Entity` ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šìœ¼ë©°, `DB, API`ë“± Data Layerì˜ ë³€ê²½ìœ¼ë¡œë¶€í„° ì˜í–¥ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤. 

**ex. ì´ë¯¸ì§€ ê´€ë ¨ UseCase**

```swift
protocol ImageUseCase {
    func uploadRx(image: UIImage) -> Observable<String>
    func downloadImageRx(urlString: String) -> Observable<UIImage>
    func deleteImageRx(urlString: String) -> Observable<Void>
}

final class DefaultImageUseCase: ImageUseCase {

    private let imageRepository: ImageRepository

    init(imageRepository: ImageRepository) {
        self.imageRepository = imageRepository
    }

    func uploadRx(image: UIImage) -> Observable<String> {
        return Observable.create { [weak self] emitter in
            self?.imageRepository.upload(image: image) { result in
                switch result {
                case .success(let url):
                    emitter.onNext(url)
                    emitter.onCompleted()
                case .failure(let error):
                    emitter.onError(error)
                }
            }
            return Disposables.create()
        }
    }

    func downloadImageRx(urlString: String) -> Observable<UIImage> {
        return Observable.create { [weak self] emitter in
            self?.imageRepository.downloadImage(urlString: urlString) { result in
                switch result {
                case .success(let image):
                    emitter.onNext(image)
                    emitter.onCompleted()
                case .failure(let error):
                    emitter.onError(error)
                }
            }
            return Disposables.create()
        }
    }

    func deleteImageRx(urlString: String) -> Observable<Void> {
        return Observable.create { [weak self] emitter in
            self?.imageRepository.deleteImage(urlString: urlString) {
                emitter.onCompleted()
            }
            return Disposables.create()
        }
    }
}
```





## âš’ï¸ RxSwift ì ìš©

## âš’ï¸ RxSwift ì ìš©

**ê°œìš”: API Callì„ ë¹„ë¡¯í•œ ë‹¤ì–‘í•œ ë¹„ë™ê¸° ì‹œí€€ìŠ¤ë¥¼ RxSwiftë¥¼ í†µí•´ ë” ì§ê´€ì ì´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë¦¬íŒ©í† ë§**

**í”„ë¡œì íŠ¸ ê¸°ê°„: 2023.01. ~ 2023.02**

**ì£¼ìš” ê°œë…: RxSwift, RxCocoa, Observer, Observable, Disposable**

### ê¸°ì¡´ ë¹„ë™ê¸° ë°©ì‹ ë° Data Binding ì½”ë“œ

---

-   Custom Typeì„ êµ¬í˜„í•˜ì—¬ Data Binding ì§„í–‰

```swift
final class CustomObservable<T> {
    // í´ë¡œì €
    typealias Listner = (T) -> Void
    var listener: Listner?

    var value: T {
        // ê°’ì´ ë³€í•˜ë©´ í´ë¡œì € ì‹¤í–‰
        didSet {
            listener?(value)
        }
    }

    init(_ value: T) {
        self.value = value
    }

    func bind(listener: Listner?) {
        self.listener = listener
        listener?(value)
    }
}


```

### RxSwiftë¥¼ í™œìš©í•œ Data Binding

-   **UseCase**ì˜ ë¹„ë™ê¸° ë©”ì„œë“œ(Observableì„ í†µí•´ ì´ë²¤íŠ¸ ìƒì„±) 

```swift
final class DefaultFetchClassItemUseCase: FetchClassItemUseCase {

    private let classItemRepository: ClassItemRepository

    init(classItemRepository: ClassItemRepository) {
        self.classItemRepository = classItemRepository
    }

    // MARK: - Refactoring for RxSwift
    func executeRx(param: ClassItemQuery.FetchItems) -> Observable<[ClassItem]> {
        return Observable.create() { [weak self] emitter in
            self?.classItemRepository.fetchItems(param: param) { classItems in
                emitter.onNext(classItems)
                emitter.onCompleted()
            }
            return Disposables.create()
        }
    }

    func executeRx(param: ClassItemQuery.FetchItem) -> Observable<ClassItem> {
        return Observable.create() { [weak self] emitter in
            self?.classItemRepository.fetchItem(param: param) { classItem in
                emitter.onNext(classItem)
                emitter.onCompleted()
            }
            return Disposables.create()
        }
    }
}
```

-   **ViewModel**ì—ì„œì˜ ë°ì´í„° ë°”ì¸ë”©(Observableì˜ ì´ë²¤íŠ¸ë¥¼ êµ¬ë…í•˜ì—¬ ê·¸ ê²°ê³¼ë¥¼ Observing)

```swift
public class DefaultSearchResultViewModel: SearchResultViewModel {
    
    private let fetchClassItemUseCase: FetchClassItemUseCase
    private let disposeBag = DisposeBag()
    
    // MARK: - OUTPUT
    let isNowLocationFetching: BehaviorRelay<Bool> = BehaviorRelay(value: false)
    let isNowDataFetching: BehaviorRelay<Bool> = BehaviorRelay(value: false)
    
    let currentUser: BehaviorSubject<User?> = BehaviorSubject(value: nil)
    let outPutData: BehaviorSubject<[ClassItem]> = BehaviorSubject(value: [])
    
    let classDetailViewController: BehaviorSubject<ClassDetailViewController?> = BehaviorSubject(value: nil)
    let searchKeyword: String
    
    private let viewModelData: BehaviorSubject<[ClassItem]> = BehaviorSubject(value: [])
    private var currentSegmentControlIndex: Int = 0
    
    // MARK: - Init
    init(fetchClassItemUseCase: FetchClassItemUseCase, searchKeyword: String) {
        self.fetchClassItemUseCase = fetchClassItemUseCase
        self.searchKeyword = searchKeyword
        configureLocation()
    }

    private func configureLocation() {
        isNowLocationFetching.accept(true)
        _ = User.getCurrentUserRx()
            .subscribe(
                onNext: { user in
                    self.currentUser.onNext(user)
                    self.isNowLocationFetching.accept(false)
                    guard let _ = user.detailLocation else {
                        // TODO: ìœ„ì¹˜ ì„¤ì • ì–¼ëŸ¿ í˜¸ì¶œ í•´ì•¼ë¨
                        return
                    }
                    self.fetchData()
                },
                onError: { error in
                    self.isNowLocationFetching.accept(false)
                    print("ERROR \(error)ğŸŒ”")
                }
            )
            .disposed(by: disposeBag)
    }
}

// MARK: - INPUT
extension DefaultSearchResultViewModel {
    func refreshClassItemList() {
        fetchData()
    }

    func didSelectItem(at index: Int) {
        if let classItem = try? outPutData.value()[index] {
            classDetailViewController.onNext(
                AppDIContainer()
                    .makeDIContainer()
                    .makeClassDetailViewController(classItem: classItem)
            )
            classDetailViewController.onNext(nil)
        }
    }

    func fetchData() {
        isNowDataFetching.accept(true)
        guard let currentUser = try? currentUser.value() else {
            debugPrint("ìœ ì € ì •ë³´ê°€ ì—†ê±°ë‚˜ ì•„ì§ ë°›ì•„ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤ğŸ˜­")
            isNowDataFetching.accept(false)
            return
        }
        guard let keyword = currentUser.keywordLocation else {
            debugPrint("ìœ ì €ì˜ í‚¤ì›Œë“œ ì£¼ì†Œ ì„¤ì • ê°’ì´ ì—†ìŠµë‹ˆë‹¤. ì£¼ì†Œ ì„¤ì • ë¨¼ì € í•´ì£¼ì„¸ìš”ğŸ˜­")
            isNowDataFetching.accept(false)
            return
        }
        fetchClassItemUseCase.executeRx(
            param: .fetchByKeywordSearch(
                keyword: keyword,
                searchKeyword: searchKeyword
            )
        )
        .map { (classItems) -> [ClassItem] in
            classItems.sorted { $0 > $1 }
        }
        .subscribe( onNext: { [weak self] classItems in
            self?.isNowDataFetching.accept(false)
            self?.viewModelData.onNext(classItems)
            switch self?.currentSegmentControlIndex {
            case 1:
                self?.outPutData.onNext(classItems.filter { $0.itemType == ClassItemType.buy })
            case 2:
                self?.outPutData.onNext(classItems.filter { $0.itemType == ClassItemType.sell })
            default:
                self?.outPutData.onNext(classItems)
            }
        })
        .disposed(by: disposeBag)
    }
    
    func didSelectSegmentControl(segmentControlIndex: Int) {
        self.currentSegmentControlIndex = segmentControlIndex
        
        guard let datas = try? viewModelData.value() else {
            outPutData.onNext([])
            return
        }
        
        switch segmentControlIndex {
        case 1:
            outPutData.onNext(datas.filter { $0.itemType == .buy })
        case 2:
            outPutData.onNext(datas.filter { $0.itemType == .sell })
        default:
            outPutData.onNext(datas)
        }
    }
}

```

-   **ViewController**ì˜ ë°ì´í„° ë°”ì¸ë”©

```swift
class SearchResultViewController: UIViewController {
        // ...
    // MARK: Properties
    private var viewModel: SearchResultViewModel
    private let disposeBag = DisposeBag()
    
    init(viewModel: SearchResultViewModel) {
        self.viewModel = viewModel
        super.init(nibName: nil, bundle: nil)
    }
    
    required init?(coder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }
    
    //MARK: - view lifecycle
    override func viewDidLoad() {
        super.viewDidLoad()
        setNavigationBar()
        setLayout()
        bindViewModel()
    }
    
    private func bindViewModel() {
        /// ìˆ˜ì—…ì•„ì´í…œ ë°”ì¸ë”©
        viewModel.outPutData
            .bind { [weak self] classItems in
                self?.classItemTableView.reloadData()
                if classItems.isEmpty {
                    self?.nonDataAlertLabel.isHidden = false
                } else {
                    self?.nonDataAlertLabel.isHidden = true
                }
            }
            .disposed(by: disposeBag)

        /// ì§€ì—­ëª… íŒ¨ì¹­ ì§„í–‰ì¤‘ì¸ì§€ ë°”ì¸ë”©
        viewModel.isNowLocationFetching
            .asDriver()
            .drive { [weak self] isFetching in
                isFetching ?
                self?.classItemTableView.refreshControl?.beginRefreshing() :
                self?.classItemTableView.refreshControl?.endRefreshing()
            }
            .disposed(by: disposeBag)

        /// ìˆ˜ì—… ì•„ì´í…œ íŒ¨ì¹­ì¤‘ì¸ì§€ ë°”ì¸ë”©
        viewModel.isNowDataFetching
            .asDriver()
            .drive { [weak self] isFetching in
                if isFetching {
                    self?.classItemTableView.refreshControl?.beginRefreshing()
                    self?.nonDataAlertLabel.isHidden = true
                } else {
                    self?.classItemTableView.refreshControl?.endRefreshing()
                }
            }
            .disposed(by: disposeBag)

        viewModel.classDetailViewController
            .bind { [weak self] viewController in
                if let viewController = viewController {
                    self?.navigationController?.pushViewController(viewController, animated: true)
                }
            }
            .disposed(by: disposeBag)
    }
    
        // ...
}
```


